<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Drake: Collision Cliques</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Drake
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__collision__clique.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Collision Cliques<div class="ingroups"><a class="el" href="group__algorithms.html">Algorithms</a> &raquo; <a class="el" href="group__multibody.html">Multibody Dynamics</a> &raquo; <a class="el" href="group__collision__concepts.html">Collision Concepts (RigidBodyPlant only)</a> &raquo; <a class="el" href="group__collision__filter__concepts.html">Collision Filter Concepts</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<h1><a class="anchor" id="clique_principle"></a>
The Principle</h1>
<p>Collision cliques filter collisions by defining a group (or <em>clique</em>) of collision elements. Membership in a clique precludes collision with any other member of that same clique. The underlying idea of collision cliques is that of the <a href="https://en.wikipedia.org/wiki/Clique_(graph_theory)">mathematical clique</a>. This mathematical concept applies very naturally to the graph-based discussion of collision filtering. A clique in a graph is, loosely, a completely connected subgraph; there is an edge between each of the nodes in the subgraph. For collision filtering, that implies that all of the pairs that can be created from combinations of the clique members are filtered out.</p>
<p>It is common to simulate a robot such that collisions between any two bodies of the robot are ignored (see collision_filter_sdf_semantics). This behavior is easily represented with collision cliques; the whole robot belongs to a single clique.</p>
<h1><a class="anchor" id="clique_impl"></a>
The Implementation</h1>
<p>In Drake, cliques are represented as integer identifiers. Each collision element tracks the set of cliques to which it belongs. When a pair of collision elements are considered for collision computation, their two sets of cliques are intersected; a non-empty resultant set means that this pair is filtered. The cost of the intersection is <code>O(n + m)</code>, where the two elements belong to <code>n</code> and <code>m</code> different cliques, respectively. This is the worst case. In principle, it would come up whenever the pair of collision elements are <em>not</em> filtered by a clique. In practice, this cost is mitigated as follows:</p>
<ol type="1">
<li>Clique comparisons are only evaluated when the underlying bounding volume hierarchy (BVH) is restructured. In most cases, only a small, local portion of the BVH is restructured at any time, reducing the number of actual clique tests done.</li>
<li>The representation of the clique sets to which a collision element belongs provides opportunities to short-circuit the full <code>O(n + m)</code> test in common cases.</li>
</ol>
<p>Drake automatically applies cliques in two different cases:</p><ol type="1">
<li>If a body has multiple collision elements, all of those elements are put into the same clique.</li>
<li>The collision elements of two bodies are all put into the same clique if:<ol type="a">
<li>the bodies are <em>adjacent</em> (one is the parent of the other in the tree), and</li>
<li>the joint connecting them is <em>not</em> a floating joint.</li>
</ol>
</li>
</ol>
<p>There are several implications of this:</p><ol type="1">
<li>A body that is represented by multiple, overlapping collision elements will <em>not</em> report meaningless collisions between those elements.</li>
<li>Collisions between adjacent bodies will <em>not</em> provide constraints on the valid range of joint motion. These constraints will have to act directly on the joint state value.</li>
</ol>
<dl class="section note"><dt>Note</dt><dd>These heuristics <em>may</em> lead to important collision element pairs being filtered. There is currently no interface for manipulating cliques programmatically. This will be implemented when the use case becomes clear. However, there is a workaround. As an example, consider two adjacent bodies, <code>A</code> and <code>B</code>. Their collision elements will automatically be put into a common clique. However, we may want collisions between element <code>E</code> on <code>B</code> and collision elements on <code>A</code> to <em>not</em> be filtered. We can create a massless body <code>Z</code> to hold <code>E</code> and use a weld (fixed) joint to attach <code>Z</code> to <code>B</code>. <code>Z</code> will not be adjacent to A, so <code>E</code> will interact with <code>A</code>'s elements.</dd></dl>
<p>Next topic: <a class="el" href="group__collision__filter__group.html">Collision Filter Groups</a> </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!--HTML footer for doxygen 1.8.13-->
<!--start footer part-->
<div id="nav-path" class="navpath"><!--id is needed for treeview function!-->
  <ul>
    <li class="footer">Generated by
    <a href="https://www.stack.nl/~dimitri/doxygen/">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a></li>
  </ul>
</div>
</body>
</html>
